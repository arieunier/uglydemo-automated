!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("fa-sdk-web",[],t):"object"==typeof exports?exports["fa-sdk-web"]=t():e["fa-sdk-web"]=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=19)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SDK_VERSION="1.1.0",t.SDK_PLATFORM="Web",t.ENV=Object({SDK_CHANNEL:"stable",SDK_VERSION:"1.1.0",ENV_SUFFIX:void 0,ENV_PROTOCOL:void 0,SDK_ENVIRONMENT:void 0,API_ROUTE:void 0}).ENV||"",t.ENV_DOMAIN=Object({SDK_CHANNEL:"stable",SDK_VERSION:"1.1.0",ENV_SUFFIX:void 0,ENV_PROTOCOL:void 0,SDK_ENVIRONMENT:void 0,API_ROUTE:void 0}).ENV_DOMAIN||"follow-apps.com",t.ENV_PROTOCOL="https",t.API_ROUTE="api/",t.CONFIG_STORAGE_NAME="faDeviceProperties",t.SESSION_STORAGE_NAME="faSession",t.SESSION_TO_SEND_STORAGE_NAME="faSessionToSend",t.LOCATION_STORAGE_NAME="faLocation",t.OPENED_BY_CAMPAIGN_STORAGE_NAME="faCampaigns",t.FAILED_REQUESTS_TO_REDEPLOY=3,t.SESSION_AUTO_UPDATE_DELAY=1e3,t.SESSION_TIMEOUT=120,t.SESSION_LOGGER_UPLOAD_DELAY=8e3,t.GEO_LOCATION_UPDATE_DELAY=3e4,t.GEO_LOCATION_MAXIMUM_AGE=33e3,t.PUSH_NOTOFICATION_RENEWAL_INTERVAL=36e5,t.DEBUG_EXCLUDED_EVENTS=["SESSION_UPDATED"],t.INPUT_CHAIN_KEY="==follow==",t.CAMPAIGN_LOG_REGISTERATION_TIMEOUT=6048e5,t.OPT_IN_ANALYTICS_NAME="FollowAnalyticsTrackingState"},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.TEST_EVENT=0]="TEST_EVENT",e[e.WINDOW_STATE_CHANGED=1]="WINDOW_STATE_CHANGED",e[e.GET_USER_INFO=2]="GET_USER_INFO",e[e.ACTION_LOGGED=3]="ACTION_LOGGED",e[e.SESSION_ID_RECEIVED=4]="SESSION_ID_RECEIVED",e[e.SESSION_UPDATED=5]="SESSION_UPDATED",e[e.SESSION_ENDED=6]="SESSION_ENDED",e[e.INIT_SESSION_START=7]="INIT_SESSION_START",e[e.INIT_SESSION_STOP=8]="INIT_SESSION_STOP",e[e.SET_USER_LOCATION=9]="SET_USER_LOCATION",e[e.SDK_DEPLOYED=10]="SDK_DEPLOYED",e[e.APP_OPENED_FROM_PUSH=11]="APP_OPENED_FROM_PUSH"}(o||(o={})),t.default=o},function(e,t,n){"use strict";var o=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),r=n(13),a=n(8),s=n(14),u=n(0),c=n(9),l=n(34),f=n(7),d=n(1),p=n(17),h=n(40),g=n(41),S=n(43),y=n(44),v=n(18),m=n(46),_=n(11),b=n(49),O=function(){function e(){this.bundleVersion="1.0",this.sessionTimeout=null,this.geolocationEnabled=!1,this.geolocationService=null,this.currentRetryCount=1,this.initialRetryDelay=1e4,this.isVerbose=!1,this.isReady=!1,this.sdkBaseUrl=null,this.deviceIdCharsCount=0}return e.prototype.initialize=function(e){var t=this;void 0===e&&(e={}),this.setupFaDeviceConfig(e),this.optInAnalytics=!1!==i.get(u.OPT_IN_ANALYTICS_NAME),this.analyticsScope=e.analyticsScope||_.default.FULL,this.session=new l.default,this.registerSession(),this.sdkBaseUrl=e.sdkBaseUrl||null,this.env=e.env||u.ENV,this.envDomain=e.envDomain||u.ENV_DOMAIN,this.envProtocol=e.envProtocol||u.ENV_PROTOCOL,this.defaultIcon=e.defaultIcon||null;var n=new g.default;this.userInfo=n.getUserInfo(),this.webPushService=new m.default,this.geolocationService=new S.default(this.geolocationEnabled),this.windowStateHandler=new h.default,this.clearFAHistoryLogQueue(),this.registerServices([n,this.geolocationService,this.windowStateHandler,new y.default,new v.default,this.webPushService]),this.listenInputChain(),this.deploy().then(function(){t.webPushService.checkOpenedByCampaign(),t.webPushService.evaluateServiceWorkerValidity()})},e.prototype.setupFaDeviceConfig=function(e){void 0===e&&(e={}),a.default(this.getConfigStorage())&&(e.deviceId=b(),i.set(u.CONFIG_STORAGE_NAME,Object.assign({},e,this.userInfo)));var t=this.getConfigStorage();this.FAID=e.FAID||t.FAID,this.bundleId=e.bundleId||t.bundleId,this.userId=t.userId||e.userId,this.deviceId=t.deviceId||e.deviceId,this.env=e.env||u.ENV,this.envDomain=e.envDomain||u.ENV,this.envProtocol=e.envProtocol||u.ENV_PROTOCOL,this.bundleVersion=t.bundleVersion||e.bundleVersion,this.isVerbose=e.isVerbose||!1,this.sessionTimeout=e.sessionTimeout||u.SESSION_TIMEOUT,this.geolocationEnabled=e.geolocationEnabled||!1},e.prototype.registerServices=function(e){for(var t=p.default.initialize(),n=0;n<e.length;n+=1)t.register(e[n])},e.prototype.registerSession=function(){p.default.initialize().register(this.session)},e.prototype.listenInputChain=function(){var e=this;r.add(document,"keypress",function(t){var n=u.INPUT_CHAIN_KEY.split(""),o=t.key;n[e.deviceIdCharsCount]===o?e.deviceIdCharsCount++:e.deviceIdCharsCount=0,e.deviceIdCharsCount===n.length&&(e.deviceIdCharsCount=0,prompt("Copy to clipboard: Ctrl+C, Enter",e.getDeviceId()))})},e.prototype.getConfigStorage=function(e){void 0===e&&(e=null);var t=i.get(u.CONFIG_STORAGE_NAME)||{};return e?t[e]:t},e.prototype.getSession=function(){return this.session},e.prototype.getSessionLogs=function(){return i.get(u.SESSION_TO_SEND_STORAGE_NAME)||[]},e.prototype.checkUserLocation=function(){this.geolocationEnabled&&this.geolocationService.getUserLocation()},e.prototype.deploy=function(){var e={FAID:this.FAID,sdkPlatform:u.SDK_PLATFORM,sdkVersion:u.SDK_VERSION};return this.getDeployPromise(e)},e.prototype.retryDeploymentEndpoint=function(){var e=this;setTimeout(function(){e.deploy().then(function(e){return!0}).catch(function(e){return new Error("could not find correct domain")})},this.currentRetryCount*this.initialRetryDelay+1)},e.prototype.clearFAHistoryLogQueue=function(){i.remove("faLogs")},e.prototype.getDeployPromise=function(e){var t=this;return new s(function(n,o){c.default.deploy(e,function(e){t.isReady||t.session.initSession(),t.isReady=!0,p.default.initialize().notifyEveryone(new f.default(d.default.SDK_DEPLOYED,null)),e.success?(t.sdkBaseUrl=e.result.service_domain,n()):(t.sdkBaseUrl=null,t.retryDeploymentEndpoint(),t.currentRetryCount+=1,o())})})},e.prototype.registerForPushNotification=function(){var e=this;if(navigator.serviceWorker&&window.PushManager&&void 0!==this.webPushService)return this.webPushService.register().then(function(){e.updateStoreWithProperty("faDeviceProperties",{isRegisteredForPush:!0})}).catch(function(t){e.updateStoreWithProperty("faDeviceProperties",{isRegisteredForPush:!1})})},e.prototype.unregisterFromPushNotification=function(){var e=this;return this.webPushService.unsubscribe().then(function(t){e.updateStoreWithProperty("faDeviceProperties",{isRegisteredForPush:!1})})},e.prototype.isRegisteredForPushNotifications=function(){return a.default(this.getConfigStorage())?s.reject(new Error("FollowAnalytics sdk is not initialized")):(this.checkNotificationPermissionChanges(),this.hasNotificationPermission()&&!!i.get("faDeviceProperties").isRegisteredForPush)},e.prototype.hasNotificationPermission=function(){if(window.Notification){var e=Notification.permission;if(["default","denied"].indexOf(e)>=0)return!1;if("granted"===e)return!0}return!1},e.prototype.checkNotificationPermissionChanges=function(){if(window.Notification){var e=i.get("faDeviceProperties").isRegisteredForPush,t=Notification.permission,n=!(["default","denied"].indexOf(t)>=0);n!==e&&(!1===n?(navigator.serviceWorker.controller.postMessage("unregisterFromPushNotification"),this.updateStoreWithProperty("faDeviceProperties",{isRegisteredForPush:!1})):!0===n&&this.registerForPushNotification())}},e.prototype.updateStoreWithProperty=function(e,t){var n=i.get(e);i.set(e,o({},n,t))},e.prototype.setUserId=function(e){if(e!==this.userId)return null===this.userId&&null!==e?(this.userId=e,void this.updateCurrentStoreUser(e)):void this.initSession(e)},e.prototype.initSession=function(e){var t=p.default.initialize();t.notifyEveryone(new f.default(d.default.INIT_SESSION_STOP,{autoStart:!1})),this.userId=e,this.updateCurrentStoreUser(e),t.notifyEveryone(new f.default(d.default.INIT_SESSION_START,null))},e.prototype.updateCurrentStoreUser=function(e){var t=this.getConfigStorage();t.userId=e,i.set(u.CONFIG_STORAGE_NAME,t)},e.prototype.getFAID=function(){return this.FAID},e.prototype.getSdkBaseUrl=function(){return this.sdkBaseUrl},e.prototype.getBundleId=function(){return this.bundleId},e.prototype.getBundleVersion=function(){return this.bundleVersion},e.prototype.getSessionTimeout=function(){return this.sessionTimeout},e.prototype.getUserId=function(){return this.userId},e.prototype.getDeviceId=function(){return this.deviceId},e.prototype.getUserInfo=function(){return this.userInfo},e.prototype.getCountryCode=function(){return this.countryCode},e.prototype.getDefaultIcon=function(){return this.defaultIcon},e.prototype.getEnvProtocol=function(){return this.envProtocol},e.prototype.getEnv=function(){return this.formatEnv()},e.prototype.getEnvDomain=function(){return this.envDomain},e.prototype.getEnvironment=function(){return this.env},e.prototype.formatEnv=function(){var e=this.env;return this.env&&0!==this.env.trim().length?this.stringStarstWithChar(this.env,"-")?this.env:"-"+e:""},e.prototype.isForeground=function(){return this.windowStateHandler.isForeground()},e.prototype.stringStarstWithChar=function(e,t){return e.length>0&&e.substring(0,t.length)===t},e.prototype.getOptInAnalytics=function(){return this.optInAnalytics},e.prototype.setOptInAnalytics=function(e){e!==this.optInAnalytics&&(i.set(u.OPT_IN_ANALYTICS_NAME,e),this.optInAnalytics=e,!1===e&&this.session.endSession(),!0===e&&(this.session=new l.default,this.session.initSession()))},e}();t.default=new O},function(e,t,n){var o=n(21),i=n(22),r=[n(29)];e.exports=o.createStore(i,r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(17),i=function(){function e(){}return e.prototype.handleNotification=function(e){},e.prototype.notifyEveryone=function(t){e.observersBroker.notifyEveryone(t)},e.observersBroker=o.default.initialize(),e}();t.default=i},function(e,t,n){(function(t){function n(e,t){return Array.prototype.slice.call(e,t||0)}function o(e,t){i(e,function(e,n){return t(e,n),!1})}function i(e,t){if(r(e)){for(var n=0;n<e.length;n++)if(t(e[n],n))return e[n]}else for(var o in e)if(e.hasOwnProperty(o)&&t(e[o],o))return e[o]}function r(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}var a=Object.assign?Object.assign:function(e,t,n,i){for(var r=1;r<arguments.length;r++)o(Object(arguments[r]),function(t,n){e[n]=t});return e},s=function(){function e(){}return Object.create?function(e,t,o,i){var r=n(arguments,1);return a.apply(this,[Object.create(e)].concat(r))}:function(t,o,i,r){var s=n(arguments,1);return e.prototype=t,a.apply(this,[new e].concat(s))}}(),u=String.prototype.trim?function(e){return String.prototype.trim.call(e)}:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},c="undefined"!=typeof window?window:t;e.exports={assign:a,create:s,trim:u,bind:function(e,t){return function(){return t.apply(e,Array.prototype.slice.call(arguments,0))}},slice:n,each:o,map:function(e,t){var n=r(e)?[]:{};return i(e,function(e,o){return n[o]=t(e,o),!1}),n},pluck:i,isList:r,isFunction:function(e){return e&&"[object Function]"==={}.toString.call(e)},isObject:function(e){return e&&"[object Object]"==={}.toString.call(e)},Global:c}}).call(t,n(6))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){this.type=e,this.payload=t}return e.prototype.getType=function(){return this.type},e.prototype.getPayload=function(){return this.payload},e}();t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(10),r=n(2),a=function(){function e(){this.loggerDomain=""}return e.prototype.deploy=function(e,t){var n=this;this.dispatchPostRequest("deployment",e,function(e){e&&e.success&&(n.loggerDomain=e.result.service_domain,r.default.countryCode=e.result.countryCode),t(e)})},e.prototype.dispatchPostRequest=function(e,t,n){void 0===n&&(n=null);var o=JSON.stringify(t);try{var r;window.XDomainRequest?((r=new window.XDomainRequest).timeout=3e3,r.onload=function(){n&&n(JSON.parse(r.responseText)),i.default("_req :: ",r.responseText)},r.onprogress=function(){},r.ontimeout=r.onerror=function(){n&&n({error:r.responseText,success:!1})},r.open("POST",this.getApiUrl(e),!0)):((r=new XMLHttpRequest).open("POST",this.getApiUrl(e),!0),r.setRequestHeader("Content-Type","application/json; charset=utf-8")),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status)n&&n(JSON.parse(r.response)),i.default("_req :: ",r);else{var e="Bad HTTP status: "+r.status+" "+r.statusText;n&&n({error:e,success:!1})}},r.send(o)}catch(e){console.error(e)}},e.prototype.getApiUrl=function(e){var t=""+o.API_ROUTE,n="deployment"===e?"auth":this.loggerDomain,i=""===r.default.getEnv()?".":r.default.getEnv()+".",a=r.default.getEnvDomain();return r.default.getEnvProtocol()+"://"+n+i+a+"/"+t+e},e}();t.default=new a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(2);t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.default.isVerbose&&console.log.apply(console,e)}},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.FULL="full",e.PUSH="push"}(o||(o={})),t.default=o},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.FOREGROUND=0]="FOREGROUND",e[e.BACKGROUND=1]="BACKGROUND",e[e.CLOSED=2]="CLOSED"}(o||(o={})),t.default=o},function(e,t,n){var o,i;void 0===(i="function"==typeof(o=function(){function e(e,t){return function(n,o,i,r){n[e]?n[e](o,i,r):n[t]&&n[t]("on"+o,i)}}return{add:e("addEventListener","attachEvent"),remove:e("removeEventListener","detachEvent")}})?o.call(t,n,t,e):o)||(e.exports=i)},function(e,t,n){(function(t){!function(n){function o(){}function i(e){if(!(this instanceof i))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(e,this)}function r(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,i._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var o;try{o=n(e._value)}catch(e){return void s(t.promise,e)}a(t.promise,o)}else(1===e._state?a:s)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof i)return e._state=3,e._value=t,void u(e);if("function"==typeof n)return void c((o=n,r=t,function(){o.apply(r,arguments)}),e)}e._state=1,e._value=t,u(e)}catch(t){s(e,t)}var o,r}function s(e,t){e._state=2,e._value=t,u(e)}function u(e){2===e._state&&0===e._deferreds.length&&i._immediateFn(function(){e._handled||i._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)r(e,e._deferreds[t]);e._deferreds=null}function c(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,s(t,e))})}catch(e){if(n)return;n=!0,s(t,e)}}var l=setTimeout;i.prototype.catch=function(e){return this.then(null,e)},i.prototype.then=function(e,t){var n=new this.constructor(o);return r(this,new function(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}(e,t,n)),n},i.all=function(e){return new i(function(t,n){function o(e,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(t){o(e,t)},n)}i[e]=a,0==--r&&t(i)}catch(e){n(e)}}if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(e);if(0===i.length)return t([]);for(var r=i.length,a=0;a<i.length;a++)o(a,i[a])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)})},i.reject=function(e){return new i(function(t,n){n(e)})},i.race=function(e){return new i(function(t,n){for(var o=0,i=e.length;o<i;o++)e[o].then(t,n)})},i._immediateFn="function"==typeof t&&function(e){t(e)}||function(e){l(e,0)},i._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},i._setImmediateFn=function(e){i._immediateFn=e},i._setUnhandledRejectionFn=function(e){i._unhandledRejectionFn=e},void 0!==e&&e.exports?e.exports=i:n.Promise||(n.Promise=i)}(this)}).call(t,n(31).setImmediate)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(35);t.default=function(e,t){for(var n=Object.keys(t),i=0;i<n.length;i+=1){var r=n[i];o(e[r])?e[r]=new Date(t[r]):e[r]=t[r]}}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(1),r=n(10),a=function(){function e(){this.observers=[]}return e.initialize=function(){return null===e.instance&&(e.instance=new e),e.instance},e.prototype.register=function(e){this.observers.push(e)},e.prototype.notifyEveryone=function(e){var t=i.default[e.getType()];-1===o.DEBUG_EXCLUDED_EVENTS.indexOf(t)&&r.default("InnerSDKEvent:: ",t,"::",e.getPayload());for(var n=0;n<this.observers.length;n+=1)this.observers[n].handleNotification(e)},e.instance=null,e}();t.default=a},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),s=n(0),u=n(4),c=n(1),l=n(2),f=n(9),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t.prototype.handleNotification=function(e){switch(e.getType()){case c.default.ACTION_LOGGED:this.saveLog(e);break;case c.default.SESSION_UPDATED:this.saveSessionData(e);break;case c.default.SESSION_ENDED:this.markSessionAsEnded(e),this.clearSessionData()}},t.prototype.markSessionAsEnded=function(e){var t=a.get(s.SESSION_TO_SEND_STORAGE_NAME),n=e.getPayload().id,o=t[n];o&&(o.ended=!0,t[n]=o),a.set(s.SESSION_TO_SEND_STORAGE_NAME,t)},t.prototype.saveLog=function(e){var t=e.getPayload().sessionId,n=a.get(s.SESSION_TO_SEND_STORAGE_NAME);n||(n={}),n[t]=n[t]||{logs:[],internal_id:t,id:null,fetching:!1,ended:!1},n[t].logs.push(e.getPayload()),a.set(s.SESSION_TO_SEND_STORAGE_NAME,n),this.updateStoredSessionsMissingSessionId()},t.prototype.saveSessionData=function(e){a.set(s.SESSION_STORAGE_NAME,e.getPayload())},t.prototype.clearSessionData=function(){a.remove(s.SESSION_STORAGE_NAME)},t.prototype.updateStoredSessionsMissingSessionId=function(){for(var e=this.sessionsWithoutSessionIdNotFetching(),t=0;t<e.length;t++){var n=e[t],o=a.get(s.SESSION_TO_SEND_STORAGE_NAME),i=o[n];i.fetching=!0,o[n]=i,a.set(s.SESSION_TO_SEND_STORAGE_NAME,o),this.fetchAndAttributeSessionId(n)}},t.prototype.sessionsWithoutSessionIdNotFetching=function(){for(var e=a.get(s.SESSION_TO_SEND_STORAGE_NAME),t=Object.keys(e),n=[],o=0;o<t.length;o++){var i=t[o];null===e[i].id&&!1===e[i].fetching&&n.push(t[o])}return n},t.prototype.fetchAndAttributeSessionId=function(e){var t=this;if(null!==l.default.getSdkBaseUrl()&&null!==e){var n={FAID:l.default.getFAID(),sessionData:r({bundleId:l.default.getBundleId(),bundleVersion:l.default.getBundleVersion(),sessionTimeout:l.default.getSessionTimeout(),deviceId:l.default.getDeviceId(),sdkPlatform:s.SDK_PLATFORM,sdkVersion:s.SDK_VERSION,countryCode:l.default.getCountryCode()},l.default.getUserInfo())};f.default.dispatchPostRequest("sessionId",n,function(n){n&&n.result?t.updateStoredSession(e,n.result,!1):t.updateStoredSession(e,null,!1)})}},t.prototype.updateStoredSession=function(e,t,n){void 0===n&&(n=!1);var o=a.get(s.SESSION_TO_SEND_STORAGE_NAME),i=o[e];i&&(null===t?i.fetching=!1:(i.fetching=!0,i.id=t.sessionId),o[e]=i,a.set(s.SESSION_TO_SEND_STORAGE_NAME,o))},t}(u.default);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(8),i=n(20);!window||window.hasOwnProperty("FollowAnalytics")&&!o.default(window.FollowAnalytics)||(window.FollowAnalytics=i.default)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=n(2),r=n(11),a=function(){function e(){this.Gender={MALE:1,FEMALE:2,OTHER:3},this.AnalyticsScope=r.default}return e.prototype.initialize=function(e){void 0===e&&(e={}),i.default.initialize(e)},e.prototype.getVersion=function(){return o.SDK_VERSION},e.prototype.getSessionInfo=function(){if(i.default.isReady)return i.default.getSession().getSessionData()},e.prototype.getSessionLogs=function(){if(i.default.isReady)return i.default.getSessionLogs()},e.prototype.getUserId=function(){return i.default.getUserId()},e.prototype.getDeviceId=function(){return i.default.getDeviceId()},e.prototype.setUserId=function(e){i.default.setUserId(e)},e.prototype.logEvent=function(e,t){void 0===t&&(t={});var n={logName:e,logDetails:t};i.default.getSession().addEvent(n)},e.prototype.logError=function(e,t){void 0===t&&(t={});var n={logName:e,logDetails:t};i.default.getSession().addError(n)},e.prototype.registerForPushNotifications=function(){return i.default.registerForPushNotification()},e.prototype.unregisterFromPushNotifications=function(){return i.default.unregisterFromPushNotification()},e.prototype.isRegisteredForPushNotifications=function(){return i.default.isRegisteredForPushNotifications()},e.prototype.getEnvironment=function(){return i.default.getEnvironment()},e.prototype.getOptInAnalytics=function(){return i.default.getOptInAnalytics()},e.prototype.setOptInAnalytics=function(e){i.default.setOptInAnalytics(e)},e.prototype.getAnalyticsScope=function(){return i.default.analyticsScope},e}();t.default=new a},function(e,t,n){function o(e,t,n){n||(n=""),e&&!l(e)&&(e=[e]),t&&!l(t)&&(t=[t]);var o=n?"__storejs_"+n+"_":"",i=n?new RegExp("^"+o):null;if(!/^[a-zA-Z0-9_\-]*$/.test(n))throw new Error("store.js namespaces can only have alphanumerics + underscores and dashes");var h=c({_namespacePrefix:o,_namespaceRegexp:i,_testStorage:function(e){try{var t="__storejs__test__";e.write(t,t);var n=e.read(t)===t;return e.remove(t),n}catch(e){return!1}},_assignPluginFnProp:function(e,t){var n=this[t];this[t]=function(){var t=r(arguments,0),o=this,i=[function(){if(n)return s(arguments,function(e,n){t[n]=e}),n.apply(o,t)}].concat(t);return e.apply(o,i)}},_serialize:function(e){return JSON.stringify(e)},_deserialize:function(e,t){if(!e)return t;var n="";try{n=JSON.parse(e)}catch(t){n=e}return void 0!==n?n:t},_addStorage:function(e){this.enabled||this._testStorage(e)&&(this.storage=e,this.enabled=!0)},_addPlugin:function(e){var t=this;if(l(e))s(e,function(e){t._addPlugin(e)});else if(!a(this.plugins,function(t){return e===t})){if(this.plugins.push(e),!f(e))throw new Error("Plugins must be function values that return objects");var n=e.call(this);if(!d(n))throw new Error("Plugins must return an object of function properties");s(n,function(n,o){if(!f(n))throw new Error("Bad plugin property: "+o+" from plugin "+e.name+". Plugins should only return functions.");t._assignPluginFnProp(n,o)})}},addStorage:function(e){!function(){var e="undefined"==typeof console?null:console;e&&(e.warn?e.warn:e.log).apply(e,arguments)}("store.addStorage(storage) is deprecated. Use createStore([storages])"),this._addStorage(e)}},p,{plugins:[]});return h.raw={},s(h,function(e,t){f(e)&&(h.raw[t]=u(h,e))}),s(e,function(e){h._addStorage(e)}),s(t,function(e){h._addPlugin(e)}),h}var i=n(5),r=i.slice,a=i.pluck,s=i.each,u=i.bind,c=i.create,l=i.isList,f=i.isFunction,d=i.isObject;e.exports={createStore:o};var p={version:"2.0.12",enabled:!1,get:function(e,t){var n=this.storage.read(this._namespacePrefix+e);return this._deserialize(n,t)},set:function(e,t){return void 0===t?this.remove(e):(this.storage.write(this._namespacePrefix+e,this._serialize(t)),t)},remove:function(e){this.storage.remove(this._namespacePrefix+e)},each:function(e){var t=this;this.storage.each(function(n,o){e.call(t,t._deserialize(n),(o||"").replace(t._namespaceRegexp,""))})},clearAll:function(){this.storage.clearAll()},hasNamespace:function(e){return this._namespacePrefix=="__storejs_"+e+"_"},createStore:function(){return o.apply(this,arguments)},addPlugin:function(e){this._addPlugin(e)},namespace:function(e){return o(this.storage,this.plugins,e)}}},function(e,t,n){e.exports=[n(23),n(24),n(25),n(26),n(27),n(28)]},function(e,t,n){function o(){return r.localStorage}function i(e){return o().getItem(e)}var r=n(5).Global;e.exports={name:"localStorage",read:i,write:function(e,t){return o().setItem(e,t)},each:function(e){for(var t=o().length-1;t>=0;t--){var n=o().key(t);e(i(n),n)}},remove:function(e){return o().removeItem(e)},clearAll:function(){return o().clear()}}},function(e,t,n){function o(e){for(var t=r.length-1;t>=0;t--){var n=r.key(t);e(r[n],n)}}var i=n(5).Global;e.exports={name:"oldFF-globalStorage",read:function(e){return r[e]},write:function(e,t){r[e]=t},each:o,remove:function(e){return r.removeItem(e)},clearAll:function(){o(function(e,t){delete r[e]})}};var r=i.globalStorage},function(e,t,n){function o(e){return e.replace(/^\d/,"___$&").replace(c,"___")}var i=n(5).Global;e.exports={name:"oldIE-userDataStorage",write:function(e,t){if(!u){var n=o(e);s(function(e){e.setAttribute(n,t),e.save(r)})}},read:function(e){if(!u){var t=o(e),n=null;return s(function(e){n=e.getAttribute(t)}),n}},each:function(e){s(function(t){for(var n=t.XMLDocument.documentElement.attributes,o=n.length-1;o>=0;o--){var i=n[o];e(t.getAttribute(i.name),i.name)}})},remove:function(e){var t=o(e);s(function(e){e.removeAttribute(t),e.save(r)})},clearAll:function(){s(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(r);for(var n=t.length-1;n>=0;n--)e.removeAttribute(t[n].name);e.save(r)})}};var r="storejs",a=i.document,s=function(){if(!a||!a.documentElement||!a.documentElement.addBehavior)return null;var e,t,n;try{(t=new ActiveXObject("htmlfile")).open(),t.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),t.close(),e=t.w.frames[0].document,n=e.createElement("div")}catch(t){n=a.createElement("div"),e=a.body}return function(t){var o=[].slice.call(arguments,0);o.unshift(n),e.appendChild(n),n.addBehavior("#default#userData"),n.load(r),t.apply(this,o),e.removeChild(n)}}(),u=(i.navigator?i.navigator.userAgent:"").match(/ (MSIE 8|MSIE 9|MSIE 10)\./),c=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g")},function(e,t,n){function o(e){for(var t=c.cookie.split(/; ?/g),n=t.length-1;n>=0;n--)if(u(t[n])){var o=t[n].split("="),i=unescape(o[0]);e(unescape(o[1]),i)}}function i(e){e&&r(e)&&(c.cookie=escape(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/")}function r(e){return new RegExp("(?:^|;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(c.cookie)}var a=n(5),s=a.Global,u=a.trim;e.exports={name:"cookieStorage",read:function(e){if(!e||!r(e))return null;var t="(?:^|.*;\\s*)"+escape(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*((?:[^;](?!;))*[^;]?).*";return unescape(c.cookie.replace(new RegExp(t),"$1"))},write:function(e,t){e&&(c.cookie=escape(e)+"="+escape(t)+"; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/")},each:o,remove:i,clearAll:function(){o(function(e,t){i(t)})}};var c=s.document},function(e,t,n){function o(){return r.sessionStorage}function i(e){return o().getItem(e)}var r=n(5).Global;e.exports={name:"sessionStorage",read:i,write:function(e,t){return o().setItem(e,t)},each:function(e){for(var t=o().length-1;t>=0;t--){var n=o().key(t);e(i(n),n)}},remove:function(e){return o().removeItem(e)},clearAll:function(){return o().clear()}}},function(e,t){e.exports={name:"memoryStorage",read:function(e){return n[e]},write:function(e,t){n[e]=t},each:function(e){for(var t in n)n.hasOwnProperty(t)&&e(n[t],t)},remove:function(e){delete n[e]},clearAll:function(e){n={}}};var n={}},function(e,t,n){e.exports=function(){return n(30),{}}},function(module,exports){"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function this_value(){return this.valueOf()}function quote(e){return rx_escapable.lastIndex=0,rx_escapable.test(e)?'"'+e.replace(rx_escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,o,i,r,a,s=gap,u=t[e];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(e)),"function"==typeof rep&&(u=rep.call(t,e,u)),typeof u){case"string":return quote(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(u)){for(r=u.length,n=0;n<r;n+=1)a[n]=str(n,u)||"null";return i=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(r=rep.length,n=0;n<r;n+=1)"string"==typeof rep[n]&&(i=str(o=rep[n],u))&&a.push(quote(o)+(gap?": ":":")+i);else for(o in u)Object.prototype.hasOwnProperty.call(u,o)&&(i=str(o,u))&&a.push(quote(o)+(gap?": ":":")+i);return i=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,i}}var rx_one=/^[\],:{}\s]*$/,rx_two=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rx_three=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rx_four=/(?:^|:|,)(?:\s*\[)+/g,rx_escapable=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,rx_dangerous=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta,rep;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},Boolean.prototype.toJSON=this_value,Number.prototype.toJSON=this_value,String.prototype.toJSON=this_value),"function"!=typeof JSON.stringify&&(meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,n){var o;if(gap="",indent="","number"==typeof n)for(o=0;o<n;o+=1)indent+=" ";else"string"==typeof n&&(indent=n);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(e,t){var n,o,i=e[t];if(i&&"object"==typeof i)for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(void 0!==(o=walk(i,n))?i[n]=o:delete i[n]);return reviver.call(e,t,i)}var j;if(text=String(text),rx_dangerous.lastIndex=0,rx_dangerous.test(text)&&(text=text.replace(rx_dangerous,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),rx_one.test(text.replace(rx_two,"@").replace(rx_three,"]").replace(rx_four,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}()},function(e,t,n){(function(e){function o(e,t){this._id=e,this._clearFn=t}var i=void 0!==e&&e||"undefined"!=typeof self&&self||window,r=Function.prototype.apply;t.setTimeout=function(){return new o(r.call(setTimeout,i,arguments),clearTimeout)},t.setInterval=function(){return new o(r.call(setInterval,i,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(i,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},n(32),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(t,n(6))},function(e,t,n){(function(e,t){!function(e,n){"use strict";function o(e){delete f[e]}function i(e){if(d)setTimeout(i,0,e);else{var t=f[e];if(t){d=!0;try{!function(e){var t=e.callback,o=e.args;switch(o.length){case 0:t();break;case 1:t(o[0]);break;case 2:t(o[0],o[1]);break;case 3:t(o[0],o[1],o[2]);break;default:t.apply(n,o)}}(t)}finally{o(e),d=!1}}}}if(!e.setImmediate){var r,a,s,u,c,l=1,f={},d=!1,p=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick(function(){i(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(u="setImmediate$"+Math.random()+"$",c=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(u)&&i(+t.data.slice(u.length))},e.addEventListener?e.addEventListener("message",c,!1):e.attachEvent("onmessage",c),r=function(t){e.postMessage(u+t,"*")}):e.MessageChannel?((s=new MessageChannel).port1.onmessage=function(e){i(e.data)},r=function(e){s.port2.postMessage(e)}):p&&"onreadystatechange"in p.createElement("script")?(a=p.documentElement,r=function(e){var t=p.createElement("script");t.onreadystatechange=function(){i(e),t.onreadystatechange=null,a.removeChild(t),t=null},a.appendChild(t)}):r=function(e){setTimeout(i,0,e)},h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return f[l]=o,r(l),l++},h.clearImmediate=o}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,n(6),n(33))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function r(){h&&d&&(h=!1,d.length?p=d.concat(p):g=-1,p.length&&a())}function a(){if(!h){var e=i(r);h=!0;for(var t=p.length;t;){for(d=p,p=[];++g<t;)d&&d[g].run();g=-1,t=p.length}d=null,h=!1,function(e){if(l===clearTimeout)return clearTimeout(e);if((l===o||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}(e)}}function s(e,t){this.fun=e,this.array=t}function u(){}var c,l,f=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{l="function"==typeof clearTimeout?clearTimeout:o}catch(e){l=o}}();var d,p=[],h=!1,g=-1;f.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new s(e,t)),1!==p.length||h||i(a)},s.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=u,f.addListener=u,f.once=u,f.off=u,f.removeListener=u,f.removeAllListeners=u,f.emit=u,f.prependListener=u,f.prependOnceListener=u,f.listeners=function(e){return[]},f.binding=function(e){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(e){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),s=n(0),u=n(2),c=n(15),l=n(11),f=n(4),d=n(7),p=n(1),h=n(12),g=n(36),S=n(38),y=n(39),v=function(e){function t(){var t=e.call(this)||this;return t.id=null,t.inactivityTimer=0,t.sessionAutoUpdateHandler=null,t.isPaused=!0,t.onSessionAutoUpdate=function(){t.endTime=new Date,t.handleInactivity(),t.notifyEveryone(new d.default(p.default.SESSION_UPDATED,t.getSessionData()))},t.startTime=new Date,t.endTime=new Date,t}return i(t,e),t.prototype.initSession=function(){if(!1!==u.default.getOptInAnalytics()){var e=a.get(s.SESSION_STORAGE_NAME);e?c.default(this,e):this.startSession()}},t.prototype.goForeground=function(){this.isExpired()?this.stopSession():this.resumeSession()},t.prototype.startSession=function(){this.startTime=new Date,this.endTime=new Date,this.generateSessionId(),this.addLog(S.default.FALogNameStartSession),u.default.isForeground()&&this.addLog(S.default.FALogNameEnterForeground),u.default.checkUserLocation(),this.startSessionAutoUpdate()},t.prototype.pauseSession=function(){this.isPaused||(this.addLog(S.default.FALogNameEnterBackground),this.stopSessionAutoUpdate())},t.prototype.resumeSession=function(){this.isPaused&&(this.addLog(S.default.FALogNameEnterForeground),this.startSessionAutoUpdate())},t.prototype.endSession=function(){this.stopSession(!1)},t.prototype.stopSession=function(e){void 0===e&&(e=!0),this.addLog(S.default.FALogNameEndSession),this.notifyEveryone(new d.default(p.default.SESSION_ENDED,this.getSessionData())),this.stopSessionAutoUpdate(),this.id=null,e&&this.startSession()},t.prototype.startSessionAutoUpdate=function(){this.sessionAutoUpdateHandler=setInterval(this.onSessionAutoUpdate,s.SESSION_AUTO_UPDATE_DELAY),this.isPaused=!1},t.prototype.stopSessionAutoUpdate=function(){clearInterval(this.sessionAutoUpdateHandler),this.sessionAutoUpdateHandler=null,this.isPaused=!0},t.prototype.handleInactivity=function(){this.inactivityTimer+=s.SESSION_AUTO_UPDATE_DELAY,this.inactivityTimer>=this.pingThrottler()&&this.addLog(S.default.FALogNamePing)},t.prototype.pingThrottler=function(){return this.getDuration()<180?15e3:this.getDuration()<600?3e4:this.getDuration()<1200?6e4:19999},t.prototype.addEvent=function(e){this.addLog(S.default.FALogNameCustomEvent,e)},t.prototype.addError=function(e){this.addLog(S.default.FALogNameCustomError,e)},t.prototype.addLog=function(e,t){if(void 0===t&&(t={}),!1!==u.default.getOptInAnalytics()&&(u.default.analyticsScope!==l.default.PUSH||!0===u.default.isRegisteredForPushNotifications())){this.inactivityTimer=0;var n=new g.default(r({sessionId:this.id,logName:S.default[e],logDetails:null},t,{logType:this.getLogTypeByName(e),logUpTime:this.getDuration()}));this.notifyEveryone(new d.default(p.default.ACTION_LOGGED,n.serializeToObject()))}},t.prototype.getLogTypeByName=function(e){var t=null;switch(e){case S.default.FALogNameStartSession:case S.default.FALogNameEndSession:t=y.default.System;break;case S.default.FALogNameEnterForeground:case S.default.FALogNameEnterBackground:case S.default.FALogNameLocation:case S.default.FALogNamePing:case S.default.FALogNameDidReceiveTheCampaign:case S.default.FALogNameApplicationOpenedFromPushMessage:t=y.default.Automatic;break;case S.default.FALogNameCustomError:t=y.default.Error;break;case S.default.FALogNameCustomEvent:default:t=y.default.Event}return t},t.prototype.getId=function(){return this.id},t.prototype.getStartTime=function(){return this.startTime},t.prototype.getEndTime=function(){return this.endTime},t.prototype.getDuration=function(){return this.endTime&&this.startTime?(this.endTime.getTime()-this.startTime.getTime())/1e3:0},t.prototype.isExpired=function(){return(new Date).getTime()-this.endTime.getTime()>=1e3*u.default.getSessionTimeout()},t.prototype.generateSessionId=function(){this.id="INTERNAL_"+(new Date).getTime().toString()},t.prototype.getSessionData=function(){return{id:this.id,duration:this.getDuration(),startTime:this.startTime.getTime(),endTime:this.endTime.getTime(),logUpTime:this.getDuration()}},t.prototype.handleNotification=function(e){switch(e.getType()){case p.default.WINDOW_STATE_CHANGED:this.onWindowStateChanged(e.getPayload());break;case p.default.INIT_SESSION_START:this.startSession();break;case p.default.INIT_SESSION_STOP:var t=!e.getPayload()||e.getPayload().autoStart;this.stopSession(t);break;case p.default.SET_USER_LOCATION:var n=e.getPayload().coords;this.addLog(S.default.FALogNameLocation,{logDetails:n.latitude+", "+n.longitude});break;case p.default.APP_OPENED_FROM_PUSH:this.addLog(S.default.FALogNameDidReceiveTheCampaign,{logDetails:e.getPayload().id}),this.addLog(S.default.FALogNameApplicationOpenedFromPushMessage,{logDetails:e.getPayload().id})}},t.prototype.onWindowStateChanged=function(e){switch(e.windowState){case h.default.FOREGROUND:this.goForeground();break;case h.default.BACKGROUND:this.pauseSession()}},t}(f.default);t.default=v},function(e,t,n){(function(e,n){var o,i="object"==typeof e&&e&&e.Object===Object&&e,r="object"==typeof t&&t&&!t.nodeType&&t,a=r&&"object"==typeof n&&n&&!n.nodeType&&n,s=a&&a.exports===r&&i.process,u=function(){try{return s&&s.binding("util")}catch(e){}}(),c=u&&u.isDate,l=Object.prototype.toString,f=c?(o=c,function(e){return o(e)}):function(e){return function(e){return!!e&&"object"==typeof e}(e)&&"[object Date]"==l.call(e)};n.exports=f}).call(t,n(6),n(16)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(3),i=n(0),r=n(15),a=n(37),s=function(){function e(e){var t=o.get(i.CONFIG_STORAGE_NAME),n={logInForeground:!0,logDate:new Date,logUserId:t?t.userId:null},s=Object.assign({},n,e),u=this.serializeToObject();a.default(s,u,this),a.default(u,s,this),r.default(this,s)}return e.prototype.serializeToObject=function(){return{sessionId:this.sessionId,logType:this.logType,logName:this.logName,logDate:this.logDate,logDetails:this.logDetails,logUserId:this.logUserId,logUpTime:this.logUpTime,logInForeground:this.logInForeground}},e.prototype.serializeToJSON=function(){return JSON.stringify(this.serializeToObject())},e}();t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Array.prototype.hasSameValuesAs||(Array.prototype.hasSameValuesAs=function(e){if(!e)return!1;if(this.length!==e.length)return!1;for(var t=0,n=this.length;t<n;t++)if(this[t]instanceof Array&&e[t]instanceof Array){if(!this[t].hasSameValuesAs(e[t]))return!1}else if(this[t]!==e[t])return!1;return!0}),t.default=function(e,t,n){void 0===n&&(n=null);var o=Object.keys(e).sort(),i=Object.keys(t).sort();if(!o.hasSameValuesAs(i))throw new Error((n?n.constructor.name:"Compared")+" objects mismatch")}},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.FALogNameStartSession=0]="FALogNameStartSession",e[e.FALogNameEnterForeground=1]="FALogNameEnterForeground",e[e.FALogNameEnterBackground=2]="FALogNameEnterBackground",e[e.FALogNameLocation=3]="FALogNameLocation",e[e.FALogNamePing=4]="FALogNamePing",e[e.FALogNameEndSession=5]="FALogNameEndSession",e[e.FALogNameCustomEvent=6]="FALogNameCustomEvent",e[e.FALogNameCustomError=7]="FALogNameCustomError",e[e.FALogNameDidReceiveTheCampaign=8]="FALogNameDidReceiveTheCampaign",e[e.FALogNameApplicationOpenedFromPushMessage=9]="FALogNameApplicationOpenedFromPushMessage"}(o||(o={})),t.default=o},function(e,t,n){"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.System=0]="System",e[e.Error=1]="Error",e[e.Event=2]="Event",e[e.Automatic=3]="Automatic"}(o||(o={})),t.default=o},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(13),a=n(4),s=n(12),u=n(7),c=n(1),l=function(e){function t(){var t=e.call(this)||this;return t.windowVisibilityHandler=function(e){switch(e.target.visibilityState){case"visible":t.setSessionWindowState(s.default.FOREGROUND);break;case"hidden":t.setSessionWindowState(s.default.BACKGROUND)}},t.setSessionWindowState=function(e){t.notifyEveryone(new u.default(c.default.WINDOW_STATE_CHANGED,{windowState:e}))},t.listenWindowVisibilityState(),t}return i(t,e),t.prototype.handleNotification=function(e){switch(e.getType()){case c.default.SDK_DEPLOYED:this.afterDeploy()}},t.prototype.isForeground=function(){return!document.visibilityState||"visible"===document.visibilityState},t.prototype.afterDeploy=function(){document.visibilityState&&"visible"!==document.visibilityState||this.setSessionWindowState(s.default.FOREGROUND)},t.prototype.listenWindowVisibilityState=function(){var e=this;r.add(document,"visibilitychange",function(t){e.windowVisibilityHandler(t)}),r.add(window,"beforeunload",function(){e.setSessionWindowState(s.default.BACKGROUND)})},t}(a.default);t.default=l},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(42),a=function(e){function t(){return e.call(this)||this}return i(t,e),t.prototype.getIdiomInterface=function(){return["iPad","TouchPad","Kindle","Nook","PlayBook","Transformer","Xoom"].indexOf(r.product)>-1?"tablet":r.product||["Windows Phone","Android","Symbian OS","Tablet OS","iOS"].indexOf(r.os.family)>-1?"phone":"desktop"},t.prototype.getUserInfo=function(){var e={OS:r.version,deviceType:r.name,deviceModel:r.os.family,lang:navigator.language,timezone:60*(new Date).getTimezoneOffset()*-1,interfaceIdiom:this.getIdiomInterface()};if(Intl||"undefined"!=typeof Intl){var t=Intl.DateTimeFormat().resolvedOptions().timeZone;Object.assign(e,{timezoneName:t})}return e},t}(n(4).default);t.default=a},function(e,t,n){(function(e,o){var i;/*!
 * Platform.js <https://mths.be/platform>
 * Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 * Copyright 2011-2013 John-David Dalton <http://allyoucanleet.com/>
 * Available under MIT license <https://mths.be/mit>
 */
(function(){"use strict";function r(e){return(e=String(e)).charAt(0).toUpperCase()+e.slice(1)}function a(e){return e=f(e),/^(?:webOS|i(?:OS|P))/.test(e)?e:r(e)}function s(e,t){for(var n in e)_.call(e,n)&&t(e[n],n,e)}function u(e){return null==e?r(e):b.call(e).slice(8,-1)}function c(e){return String(e).replace(/([ -])(?!$)/g,"$1?")}function l(e,t){var n=null;return function(e,t){var n=-1,o=e?e.length:0;if("number"==typeof o&&o>-1&&o<=y)for(;++n<o;)t(e[n],n);else s(e,t)}(e,function(o,i){n=t(n,o,i,e)}),n}function f(e){return String(e).replace(/^ +| +$/g,"")}var d={function:!0,object:!0},p=d[typeof window]&&window||this,h=d[typeof t]&&t,g=d[typeof e]&&e&&!e.nodeType&&e,S=h&&g&&"object"==typeof o&&o;!S||S.global!==S&&S.window!==S&&S.self!==S||(p=S);var y=Math.pow(2,53)-1,v=/\bOpera/,m=Object.prototype,_=m.hasOwnProperty,b=m.toString,O=function e(t){function n(e){return l(e,function(e,n){var o=n.pattern||c(n);return!e&&(e=RegExp("\\b"+o+" *\\d+[.\\w_]*","i").exec(t)||RegExp("\\b"+o+" *\\w+-[\\w]*","i").exec(t)||RegExp("\\b"+o+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(t))&&((e=String(n.label&&!RegExp(o,"i").test(n.label)?n.label:e).split("/"))[1]&&!/[\d.]+/.test(e[0])&&(e[0]+=" "+e[1]),n=n.label||n,e=a(e[0].replace(RegExp(o,"i"),n).replace(RegExp("; *(?:"+n+"[_-])?","i")," ").replace(RegExp("("+n+")[-_.]?(\\w)","i"),"$1 $2"))),e})}var o=p,i=t&&"object"==typeof t&&"String"!=u(t);i&&(o=t,t=null);var r=o.navigator||{},d=r.userAgent||"";t||(t=d);var h,g,S,y,m,_=i?!!r.likeChrome:/\bChrome\b/.test(t)&&!/internal|\n/i.test(b.toString()),O=i?"Object":"ScriptBridgingProxyObject",E=i?"Object":"Environment",A=i&&o.java?"JavaPackage":u(o.java),I=i?"Object":"RuntimeObject",N=/\bJava/.test(A)&&o.java,T=N&&u(o.environment)==E,w=N?"a":"α",P=N?"b":"β",D=o.document||{},x=o.operamini||o.opera,F=v.test(F=i&&x?x["[[Class]]"]:u(x))?F:x=null,R=t,M=[],C=null,L=t==d,k=L&&x&&"function"==typeof x.version&&x.version(),j=l([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"],function(e,n){return e||RegExp("\\b"+(n.pattern||c(n))+"\\b","i").exec(t)&&(n.label||n)}),U=function(e){return l(e,function(e,n){return e||RegExp("\\b"+(n.pattern||c(n))+"\\b","i").exec(t)&&(n.label||n)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),G=n([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),W=function(e){return l(e,function(e,n,o){return e||(n[G]||n[/^[a-z]+(?: +[a-z]+\b)*/i.exec(G)]||RegExp("\\b"+c(o)+"(?:\\b|\\w*\\d)","i").exec(t))&&o})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),B=function(e){return l(e,function(e,n){var o=n.pattern||c(n);return!e&&(e=RegExp("\\b"+o+"(?:/[\\d.]+|[ \\w.]*)","i").exec(t))&&(e=function(e,t,n){var o={"10.0":"10",6.4:"10 Technical Preview",6.3:"8.1",6.2:"8",6.1:"Server 2008 R2 / 7","6.0":"Server 2008 / Vista",5.2:"Server 2003 / XP 64-bit",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return t&&n&&/^Win/i.test(e)&&!/^Windows Phone /i.test(e)&&(o=o[/[\d.]+$/.exec(e)])&&(e="Windows "+o),e=String(e),t&&n&&(e=e.replace(RegExp(t,"i"),n)),e=a(e.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}(e,o,n.label||n)),e})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);if(j&&(j=[j]),W&&!G&&(G=n([W])),(h=/\bGoogle TV\b/.exec(G))&&(G=h[0]),/\bSimulator\b/i.test(t)&&(G=(G?G+" ":"")+"Simulator"),"Opera Mini"==U&&/\bOPiOS\b/.test(t)&&M.push("running in Turbo/Uncompressed mode"),"IE"==U&&/\blike iPhone OS\b/.test(t)?(W=(h=e(t.replace(/like iPhone OS/,""))).manufacturer,G=h.product):/^iP/.test(G)?(U||(U="Safari"),B="iOS"+((h=/ OS ([\d_]+)/i.exec(t))?" "+h[1].replace(/_/g,"."):"")):"Konqueror"!=U||/buntu/i.test(B)?W&&"Google"!=W&&(/Chrome/.test(U)&&!/\bMobile Safari\b/i.test(t)||/\bVita\b/.test(G))||/\bAndroid\b/.test(B)&&/^Chrome/.test(U)&&/\bVersion\//i.test(t)?(U="Android Browser",B=/\bAndroid\b/.test(B)?B:"Android"):"Silk"==U?(/\bMobi/i.test(t)||(B="Android",M.unshift("desktop mode")),/Accelerated *= *true/i.test(t)&&M.unshift("accelerated")):"PaleMoon"==U&&(h=/\bFirefox\/([\d.]+)\b/.exec(t))?M.push("identifying as Firefox "+h[1]):"Firefox"==U&&(h=/\b(Mobile|Tablet|TV)\b/i.exec(t))?(B||(B="Firefox OS"),G||(G=h[1])):!U||(h=!/\bMinefield\b/i.test(t)&&/\b(?:Firefox|Safari)\b/.exec(U))?(U&&!G&&/[\/,]|^[^(]+?\)/.test(t.slice(t.indexOf(h+"/")+8))&&(U=null),(h=G||W||B)&&(G||W||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(B))&&(U=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(B)?B:h)+" Browser")):"Electron"==U&&(h=(/\bChrome\/([\d.]+)\b/.exec(t)||0)[1])&&M.push("Chromium "+h):B="Kubuntu",k||(k=l(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",c(U),"(?:Firefox|Minefield|NetFront)"],function(e,n){return e||(RegExp(n+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(t)||0)[1]||null})),(h=("iCab"==j&&parseFloat(k)>3?"WebKit":/\bOpera\b/.test(U)&&(/\bOPR\b/.test(t)?"Blink":"Presto"))||/\b(?:Midori|Nook|Safari)\b/i.test(t)&&!/^(?:Trident|EdgeHTML)$/.test(j)&&"WebKit"||!j&&/\bMSIE\b/i.test(t)&&("Mac OS"==B?"Tasman":"Trident")||"WebKit"==j&&/\bPlayStation\b(?! Vita\b)/i.test(U)&&"NetFront")&&(j=[h]),"IE"==U&&(h=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(t)||0)[1])?(U+=" Mobile",B="Windows Phone "+(/\+$/.test(h)?h:h+".x"),M.unshift("desktop mode")):/\bWPDesktop\b/i.test(t)?(U="IE Mobile",B="Windows Phone 8.x",M.unshift("desktop mode"),k||(k=(/\brv:([\d.]+)/.exec(t)||0)[1])):"IE"!=U&&"Trident"==j&&(h=/\brv:([\d.]+)/.exec(t))&&(U&&M.push("identifying as "+U+(k?" "+k:"")),U="IE",k=h[1]),L){if(y="global",m=null!=(S=o)?typeof S[y]:"number",/^(?:boolean|number|string|undefined)$/.test(m)||"object"==m&&!S[y])u(h=o.runtime)==O?(U="Adobe AIR",B=h.flash.system.Capabilities.os):u(h=o.phantom)==I?(U="PhantomJS",k=(h=h.version||null)&&h.major+"."+h.minor+"."+h.patch):"number"==typeof D.documentMode&&(h=/\bTrident\/(\d+)/i.exec(t))?(k=[k,D.documentMode],(h=+h[1]+4)!=k[1]&&(M.push("IE "+k[1]+" mode"),j&&(j[1]=""),k[1]=h),k="IE"==U?String(k[1].toFixed(1)):k[0]):"number"==typeof D.documentMode&&/^(?:Chrome|Firefox)\b/.test(U)&&(M.push("masking as "+U+" "+k),U="IE",k="11.0",j=["Trident"],B="Windows");else if(N&&(R=(h=N.lang.System).getProperty("os.arch"),B=B||h.getProperty("os.name")+" "+h.getProperty("os.version")),T){try{k=o.require("ringo/engine").version.join("."),U="RingoJS"}catch(e){(h=o.system)&&h.global.system==o.system&&(U="Narwhal",B||(B=h[0].os||null))}U||(U="Rhino")}else"object"==typeof o.process&&!o.process.browser&&(h=o.process)&&("object"==typeof h.versions&&("string"==typeof h.versions.electron?(M.push("Node "+h.versions.node),U="Electron",k=h.versions.electron):"string"==typeof h.versions.nw&&(M.push("Chromium "+k,"Node "+h.versions.node),U="NW.js",k=h.versions.nw)),U||(U="Node.js",R=h.arch,B=h.platform,k=(k=/[\d.]+/.exec(h.version))?k[0]:null));B=B&&a(B)}if(k&&(h=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(k)||/(?:alpha|beta)(?: ?\d)?/i.exec(t+";"+(L&&r.appMinorVersion))||/\bMinefield\b/i.test(t)&&"a")&&(C=/b/i.test(h)?"beta":"alpha",k=k.replace(RegExp(h+"\\+?$"),"")+("beta"==C?P:w)+(/\d+\+?/.exec(h)||"")),"Fennec"==U||"Firefox"==U&&/\b(?:Android|Firefox OS)\b/.test(B))U="Firefox Mobile";else if("Maxthon"==U&&k)k=k.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(G))"Xbox 360"==G&&(B=null),"Xbox 360"==G&&/\bIEMobile\b/.test(t)&&M.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(U)&&(!U||G||/Browser|Mobi/.test(U))||"Windows CE"!=B&&!/Mobi/i.test(t))if("IE"==U&&L)try{null===o.external&&M.unshift("platform preview")}catch(e){M.unshift("embedded")}else(/\bBlackBerry\b/.test(G)||/\bBB10\b/.test(t))&&(h=(RegExp(G.replace(/ +/g," *")+"/([.\\d]+)","i").exec(t)||0)[1]||k)?(B=((h=[h,/BB10/.test(t)])[1]?(G=null,W="BlackBerry"):"Device Software")+" "+h[0],k=null):this!=s&&"Wii"!=G&&(L&&x||/Opera/.test(U)&&/\b(?:MSIE|Firefox)\b/i.test(t)||"Firefox"==U&&/\bOS X (?:\d+\.){2,}/.test(B)||"IE"==U&&(B&&!/^Win/.test(B)&&k>5.5||/\bWindows XP\b/.test(B)&&k>8||8==k&&!/\bTrident\b/.test(t)))&&!v.test(h=e.call(s,t.replace(v,"")+";"))&&h.name&&(h="ing as "+h.name+((h=h.version)?" "+h:""),v.test(U)?(/\bIE\b/.test(h)&&"Mac OS"==B&&(B=null),h="identify"+h):(h="mask"+h,U=F?a(F.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(h)&&(B=null),L||(k=null)),j=["Presto"],M.push(h));else U+=" Mobile";(h=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(t)||0)[1])&&(h=[parseFloat(h.replace(/\.(\d)$/,".0$1")),h],"Safari"==U&&"+"==h[1].slice(-1)?(U="WebKit Nightly",C="alpha",k=h[1].slice(0,-1)):k!=h[1]&&k!=(h[2]=(/\bSafari\/([\d.]+\+?)/i.exec(t)||0)[1])||(k=null),h[1]=(/\bChrome\/([\d.]+)/i.exec(t)||0)[1],537.36==h[0]&&537.36==h[2]&&parseFloat(h[1])>=28&&"WebKit"==j&&(j=["Blink"]),L&&(_||h[1])?(j&&(j[1]="like Chrome"),h=h[1]||((h=h[0])<530?1:h<532?2:h<532.05?3:h<533?4:h<534.03?5:h<534.07?6:h<534.1?7:h<534.13?8:h<534.16?9:h<534.24?10:h<534.3?11:h<535.01?12:h<535.02?"13+":h<535.07?15:h<535.11?16:h<535.19?17:h<536.05?18:h<536.1?19:h<537.01?20:h<537.11?"21+":h<537.13?23:h<537.18?24:h<537.24?25:h<537.36?26:"Blink"!=j?"27":"28")):(j&&(j[1]="like Safari"),h=(h=h[0])<400?1:h<500?2:h<526?3:h<533?4:h<534?"4+":h<535?5:h<537?6:h<538?7:h<601?8:"8"),j&&(j[1]+=" "+(h+="number"==typeof h?".x":/[.+]/.test(h)?"":"+")),"Safari"==U&&(!k||parseInt(k)>45)&&(k=h)),"Opera"==U&&(h=/\bzbov|zvav$/.exec(B))?(U+=" ",M.unshift("desktop mode"),"zvav"==h?(U+="Mini",k=null):U+="Mobile",B=B.replace(RegExp(" *"+h+"$"),"")):"Safari"==U&&/\bChrome\b/.exec(j&&j[1])&&(M.unshift("desktop mode"),U="Chrome Mobile",k=null,/\bOS X\b/.test(B)?(W="Apple",B="iOS 4.3+"):B=null),k&&0==k.indexOf(h=/[\d.]+$/.exec(B))&&t.indexOf("/"+h+"-")>-1&&(B=f(B.replace(h,""))),j&&!/\b(?:Avant|Nook)\b/.test(U)&&(/Browser|Lunascape|Maxthon/.test(U)||"Safari"!=U&&/^iOS/.test(B)&&/\bSafari\b/.test(j[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(U)&&j[1])&&(h=j[j.length-1])&&M.push(h),M.length&&(M=["("+M.join("; ")+")"]),W&&G&&G.indexOf(W)<0&&M.push("on "+W),G&&M.push((/^on /.test(M[M.length-1])?"":"on ")+G),B&&(h=/ ([\d.+]+)$/.exec(B),g=h&&"/"==B.charAt(B.length-h[0].length-1),B={architecture:32,family:h&&!g?B.replace(h[0],""):B,version:h?h[1]:null,toString:function(){var e=this.version;return this.family+(e&&!g?" "+e:"")+(64==this.architecture?" 64-bit":"")}}),(h=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(R))&&!/\bi686\b/i.test(R)?(B&&(B.architecture=64,B.family=B.family.replace(RegExp(" *"+h),"")),U&&(/\bWOW64\b/i.test(t)||L&&/\w(?:86|32)$/.test(r.cpuClass||r.platform)&&!/\bWin64; x64\b/i.test(t))&&M.unshift("32-bit")):B&&/^OS X/.test(B.family)&&"Chrome"==U&&parseFloat(k)>=39&&(B.architecture=64),t||(t=null);var V={};return V.description=t,V.layout=j&&j[0],V.manufacturer=W,V.name=U,V.prerelease=C,V.product=G,V.ua=t,V.version=U&&k,V.os=B||{architecture:null,family:null,version:null,toString:function(){return"null"}},V.parse=e,V.toString=function(){return this.description||""},V.version&&M.unshift(k),V.name&&M.unshift(U),B&&U&&(B!=String(B).split(" ")[0]||B!=U.split(" ")[0]&&!G)&&M.push(G?"("+B+")":"on "+B),M.length&&(V.description=M.join(" ")),V}();p.platform=O,void 0===(i=function(){return O}.call(t,n,t,e))||(e.exports=i)}).call(this)}).call(t,n(16)(e),n(6))},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),a=n(0),s=n(4),u=n(7),c=n(1),l=n(10),f=function(e){function t(t){void 0===t&&(t=!1);var n=e.call(this)||this;return t&&navigator.geolocation&&n.watchGeolocation(),n}return i(t,e),t.prototype.watchGeolocation=function(){var e=this,t={enableHighAccuracy:!1,timeout:a.GEO_LOCATION_UPDATE_DELAY,maximumAge:a.GEO_LOCATION_MAXIMUM_AGE};navigator.geolocation.watchPosition(function(t){e.checkUserLocationUpdate(t)&&e.notifyUserLocationUpdate(t)},this.watchGeolocationErrorHandler,t)},t.prototype.watchGeolocationErrorHandler=function(e){l.default("Location watch position error :: ("+e.code+"): "+e.message)},t.prototype.getUserLocation=function(){var e=this;navigator.geolocation.getCurrentPosition(function(t){e.checkUserLocationUpdate(t)&&(r.set(a.LOCATION_STORAGE_NAME,{latitude:t.coords.latitude,longitude:t.coords.longitude}),e.notifyUserLocationUpdate(t))})},t.prototype.checkUserLocationUpdate=function(e){var t=e.coords,n=t.latitude,o=t.longitude,i=r.get(a.LOCATION_STORAGE_NAME);return!i||Math.abs(n-i.latitude)>.01||Math.abs(o-i.longitude)>.01},t.prototype.notifyUserLocationUpdate=function(e){this.notifyEveryone(new u.default(c.default.SET_USER_LOCATION,e))},t}(s.default);t.default=f},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),a=n(0),s=n(4),u=n(1),c=n(12),l=n(9),f=n(45),d=n(2),p=n(18),h=function(e){function t(){var t=e.call(this)||this;return t.syncTimer=0,t.failedRequestsCount=0,t.sendLogs=function(){if(null!==d.default.getSdkBaseUrl()){t.stopSyncTimer();var e=t.getStoredSessions();if(e){var n=Object.keys(e);if(0!==n.length){for(var o=[],i=0;i<n.length;i++){var r=n[i];null!==e[r].id?o.push(r):(new p.default).fetchAndAttributeSessionId(r)}t.sendLogsForKeys(o),t.startSyncTimer()}}}},t.startSyncTimer(),t}return i(t,e),t.prototype.handleNotification=function(e){switch(e.getType()){case u.default.SESSION_ENDED:this.sendLogs();break;case u.default.WINDOW_STATE_CHANGED:switch(e.getPayload().windowState){case c.default.FOREGROUND:this.startSyncTimer();break;case c.default.BACKGROUND:this.stopSyncTimer()}}},t.prototype.startSyncTimer=function(){this.syncTimer=setTimeout(this.sendLogs,a.SESSION_LOGGER_UPLOAD_DELAY)},t.prototype.stopSyncTimer=function(){clearTimeout(this.syncTimer),this.syncTimer=null},t.prototype.generatePayloadFor=function(e){return{FAID:d.default.getFAID(),deviceId:d.default.getDeviceId(),sdkPlatform:a.SDK_PLATFORM,sdkVersion:a.SDK_VERSION,requestDate:f.default(new Date),packageName:d.default.getBundleId(),sessions:e}},t.prototype.sendLogsForKeys=function(e){var t=this.getStoredSessions();if(t){for(var n,o,i=[],r=[],a={},s=0,u=0;u<e.length;u++){var c=e[u],l=t[c],d=l.logs.map(function(e){return delete e.sessionId,e.logDate=f.default(e.logDate),e});!0===l.ended?r.push(c):a={key:c,logsSent:l.logs.length},d.length>0&&i.push((n=d,o=l.id,{logs:n,sessionId:o})),s+=l.logs.length}if(0!==s){var p=this.generatePayloadFor(i),h=this.removeSentLogsAndFinishedSession(r,a);this.dispatchLogs(p,h)}}},t.prototype.removeSentLogsAndFinishedSession=function(e,t){var n=this.getStoredSessions();if(n){for(var o=0;o<e.length;o++)delete n[e[o]];if(n[t.key]){var i=n[t.key].logs;i.splice(0,t.logsSent),n[t.key].logs=i,this.updateStoredSessions(n),this.checkAndRemoveOldSessions()}}},t.prototype.checkAndRemoveOldSessions=function(){var e=this.getStoredSessions(),t=Object.keys(e).map(function(e){return e.replace("INTERNAL_","")}).sort();t.indexOf("null")>=0&&(t.splice(t.indexOf("null"),1),delete e.null),t.pop();for(var n=0;n<t.length;n++){var o=t[n],i=e["INTERNAL_"+o];i&&(i.ended||(i.ended=!0),e["INTERNAL_"+o]=i)}this.updateStoredSessions(e)},t.prototype.getStoredSessions=function(){return r.get(a.SESSION_TO_SEND_STORAGE_NAME)},t.prototype.updateStoredSessions=function(e){r.set(a.SESSION_TO_SEND_STORAGE_NAME,e)},t.prototype.dispatchLogs=function(e,t){var n=this;void 0===t&&(t=null),l.default.dispatchPostRequest("logs",e,function(e){e.success?(n.failedRequestsCount=0,t&&t()):(n.failedRequestsCount+=1,n.failedRequestsCount===a.FAILED_REQUESTS_TO_REDEPLOY&&(d.default.deploy(),n.failedRequestsCount=0))})},t}(s.default);t.default=h},function(e,t,n){"use strict";function o(e){return("0"+e).slice(-2)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Date.parse(e),n=new Date(t),i=n.getFullYear()+"-"+o(n.getMonth()+1)+"-"+o(n.getDate());return i=(i+="T")+o(n.getHours())+":"+o(n.getMinutes())+":"+o(n.getSeconds()),i+=function(e){var t=e.getTimezoneOffset()>0?"-":"+",n=Math.abs(e.getTimezoneOffset());return t+o(Math.floor(n/60))+":"+o(n%60)}(n)}},function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=n(14),a=n(8),s=n(4),u=n(0),c=n(2),l=n(3),f=n(47),d=n(48),p=n(1),h=n(7),g=function(e){function t(){var t=e.call(this)||this;return t.syncInterval=0,t}return i(t,e),t.prototype.evaluateServiceWorkerValidity=function(){var e=this;navigator.serviceWorker&&navigator.serviceWorker.getRegistration().then(function(t){if(!t)return e.initialiseServiceWorker(),!0;var n=new URLSearchParams(t.active.scriptURL);n.has("deviceId")&&n.get("deviceId")!==c.default.getDeviceId()&&e.unsubscribeServiceWorker().then(function(){return e.initialiseServiceWorker(),!0})}).catch(function(e){return new Error("Service Worker is not available")})},t.prototype.unsubscribeServiceWorker=function(){return navigator.serviceWorker.getRegistration().then(function(e){return e.unregister()})},t.prototype.register=function(){return new r(function(e,t){Notification.requestPermission().then(function(n){"denied"===n?t(new Error("User blocked notifications")):"granted"===n&&navigator.serviceWorker.ready.then(function(t){e(navigator.serviceWorker.controller.postMessage("registerForPushNotification"))})})})},t.prototype.unsubscribe=function(){return new r(function(e,t){navigator.serviceWorker.ready.then(function(t){e(navigator.serviceWorker.controller.postMessage("unregisterFromPushNotification"))}).catch(function(e){t(new Error("Service Worker not ready!"))})})},t.prototype.initialiseServiceWorker=function(){if(!("serviceWorker"in navigator))throw new Error("Service workers unsupported");var e="/fa-sw-webpush.js?FAID="+encodeURIComponent(c.default.getFAID())+"&deviceId="+encodeURIComponent(c.default.getDeviceId())+"&bundleId="+encodeURIComponent(c.default.getBundleId())+"&envProtocol="+encodeURIComponent(c.default.getEnvProtocol())+"&env="+encodeURIComponent(c.default.getEnv())+"&envDomain="+encodeURIComponent(c.default.getEnvDomain())+"&defaultIcon="+encodeURIComponent(c.default.getDefaultIcon());navigator.serviceWorker.register(e)},t.prototype.checkOpenedByCampaign=function(){if(!a.default(f.default())&&f.default().fa_cid&&!this.campaignIsLogged(f.default().fa_cid)){var e=f.default().fa_cid,t=p.default.APP_OPENED_FROM_PUSH;this.notifyEveryone(new h.default(t,{id:e})),this.markOpenedByCampaign(e),history.replaceState({},null,d.default())}},t.prototype.markOpenedByCampaign=function(e){var t=this.getOpenedByCampaignMarks();t[Date.now()]=e,l.set(u.OPENED_BY_CAMPAIGN_STORAGE_NAME,t)},t.prototype.getOpenedByCampaignMarks=function(){if(void 0===l.get(u.OPENED_BY_CAMPAIGN_STORAGE_NAME))return{};var e=l.get(u.OPENED_BY_CAMPAIGN_STORAGE_NAME),t={};for(var n in e){var o=+n,i=e[n];Date.now()-o<u.CAMPAIGN_LOG_REGISTERATION_TIMEOUT&&(t[n]=i)}return t},t.prototype.campaignIsLogged=function(e){var t=!1,n=l.get(u.OPENED_BY_CAMPAIGN_STORAGE_NAME);for(var o in n){n[o]===e&&(t=!0);break}return t},t}(s.default);t.default=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e={};return window.location.search.substr(1).split("&").forEach(function(t){var n=t.split("="),o=decodeURIComponent(n[0]),i=decodeURIComponent(n[1]);e[o]=i}),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=function(e){for(var t=window.location.search.substring(1).split("&"),n=0;n<t.length;n++){var o=t[n].split("=");if("fa_cid"==o[0])return o[1]}return""}(),t=window.location.search.replace("?fa_cid="+e+"&","?").replace("&fa_cid="+e+"&","&").replace("?fa_cid="+e,"");return""===t?window.location.pathname:t}},function(e,t,n){var o=n(50),i=n(51);e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||o)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var s=0;s<16;++s)t[r+s]=a[s];return t||i(a)}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(n){var o=new Uint8Array(16);e.exports=function(){return n(o),o}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],o=0;o<256;++o)n[o]=(o+256).toString(16).substr(1);e.exports=function(e,t){var o=t||0,i=n;return i[e[o++]]+i[e[o++]]+i[e[o++]]+i[e[o++]]+"-"+i[e[o++]]+i[e[o++]]+"-"+i[e[o++]]+i[e[o++]]+"-"+i[e[o++]]+i[e[o++]]+"-"+i[e[o++]]+i[e[o++]]+i[e[o++]]+i[e[o++]]+i[e[o++]]+i[e[o++]]}}])});